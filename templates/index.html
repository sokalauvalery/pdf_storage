{% extends "base.html" %}
{% block header %}
<script>

var view_pages = function (download_url) {
    $('.modal-body').load(download_url, function(){
        $('#modal-pages').modal({show:true});
    });
}

</script>
{% end %}
{% block content %}

<form class="form-inline"  enctype="multipart/form-data" action="{{ reverse_url('upload') }}" method="post">
    <label for="id_file">Upload new file: </label>
    <input class="form-control" id="id_file" name="file" type="file" required="">
    <input class="btn btn-primary" type="submit" value="Upload">
</form>

{% if users_files %}
<table class="table table-striped">
        <tr>
            <td>Username</td>
            <td>File</td>
            <td>Upload date</td>
            <td></td>
        </tr>
    {% for ufile in users_files %}
        <tr>
            <td>{{ ufile.username }} </td>
            <td><a href="{{ reverse_url('download_file', 'file', ufile.file_id) }}">{{ ufile.filename }}</a></td>
            <td>{{ ufile.upload_date }}</td>
            <td>
                <button type="button" class="btn btn-info btn-xs openBtn" data-toggle="modal" data-target="#modal-pages"
                        onclick="view_pages('{{ reverse_url('view_pages', ufile.file_id)}}')">
                    View pages
                </button>
            </td>
        </tr>
    {% end %}
    </table>

        <!-- Modal -->
        <div id="modal-pages" class="modal fade" role="dialog">
          <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
              </div>
              <div class="modal-body">
                <p>Some text in the modal.</p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              </div>
            </div>

          </div>
        </div>



{% else %}
    <p>There is no uploaded files yet.</p>
{% end %}

{% end %}